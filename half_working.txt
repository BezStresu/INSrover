#include "functions.h"
uint16_t cal_count = 0;

int main (void) { 
	PIT_Init();
	uint8_t	kal_error;
	kal_error = ADC_Init();		// Inicjalizacja i kalibracja przetwornika A/C
	if(kal_error)
	{
		while(1){							// Klaibracja sie nie powiodla
			kal_error = ADC_Init();
			cal_count++;
			if(!kal_error){
				break;
			}
			else if(cal_count == 10){
				while(TRUE){
					UART_Println("Calibration failed after 10 approaches\n\rRestart device");
					DELAY(5000);
				}
			}
		}
	}
	Init_all();																							
	control_Init();
	
	UART_Println("\n-> Starting the main loop. Sleep ...\n\r");
	ADC0->SC1[0] = ADC_SC1_AIEN_MASK | ADC_SC1_ADCH(0);		// Odblokowanie przerwania i wybranie kanalu nr 0
	result_light_ok = 1;			// wybranie pierwszego pomiaru jako pomiar natezenia swiatla
	char komendy[] = "f50r30b10l90";
	rozpoznajKomendy(komendy);

}
